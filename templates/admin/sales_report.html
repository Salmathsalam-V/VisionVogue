{% extends 'admin/base.html' %}
{% block content %}
  <h1>Sales Report</h1>
  <form method="get" id="filterForm">
      <label for="period">Period:</label>
      <select name="period" id="period" onchange="toggleDateFields()">
          <option value="">Custom</option>
          <option value="daily" {% if period == 'daily' %}selected{% endif %}>Daily</option>
          <option value="weekly" {% if period == 'weekly' %}selected{% endif %}>Weekly</option>
          <option value="monthly" {% if period == 'monthly' %}selected{% endif %}>Monthly</option>
      </select>
      <div id="customDateFields">
          <label for="start_date">Start Date:</label>
          <input type="date" name="start_date" id="start_date" value="{{ start_date|date:'Y-m-d' }}">
          <label for="end_date">End Date:</label>
          <input type="date" name="end_date" id="end_date" value="{{ end_date|date:'Y-m-d' }}">
      </div>
      <button type="submit">Filter</button>
      <button type="submit" name="export_pdf" value="true">Export PDF</button>
      <button type="submit" name="export_excel" value="true">Export Excel</button>
  </form>

  <h2>Summary</h2>
  <p>Total Sales: {{ total_sales }}</p>
  <p>Total Orders: {{ total_orders }}</p>
  <p>Total Discounts: {{ total_discount }}</p>
  <!-- <p>Sub Total: {{ sub_total }}</p> -->

  <h2>Order Details</h2>
  <table>
      <thead>
          <tr>
              <th>Item Name</th>
              <th>Quantity Sold</th>
              <th>Total Discount</th>
              <th>Total Sales</th>
              <th>Total</th>
          </tr>
      </thead>
      <tbody>
          {% for item in data %}
          <tr>
              <td>{{ item.orderproduct__product__product_name }}</td>
              <td>{{ item.total_quantity }}</td>
              <td>{{ item.total_discount }}</td>
              <td>{{ item.sub_total }}</td>
              <td>{{ item.total_sales }}</td>
          </tr>
          {% endfor %}
      </tbody>
  </table>

  <script>
    function toggleDateFields() {
        const period = document.getElementById('period').value;
        const dateFields = document.getElementById('customDateFields');
        if (period === '') {
            dateFields.style.display = 'block';
        } else {
            dateFields.style.display = 'none';
        }
    }

    // Initial toggle on page load
    toggleDateFields();
  </script>
{% endblock %}
